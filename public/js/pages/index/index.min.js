function buttonAddProductToCartHandler(t,e,i,a,n,d,c,r){i.addEventListener("click",()=>{d.classList.contains(r)||a.forEach(i=>{isSelected(i,r)&&(d.classList.add(r),d.textContent="В корзине",basketFilling(t,e,{id:c,name:n,dWeight:i.getAttribute("data-weight"),weight:i.innerText,price:i.getAttribute("data-price")}))})})}function bascketHandler(e){let t=document.querySelector("div.button_basket"),r=document.querySelector(".page-4"),i=r.querySelector("button.b1"),n=r.querySelector("button.b2"),l=r.querySelector("button.b3");t.addEventListener("click",()=>{if(e.firstChild){r.style.display="grid";let e=document.querySelector("div.dlCost"),t=document.querySelector("div.dlInfo-2"),i=document.querySelector(".total_price__item");setDeliveryPrice(i.textContent,e,t)}else alert("Корзина пустая :(")}),i.addEventListener("click",()=>{r.style.display="none"}),n.addEventListener("click",()=>{let t=document.querySelector(".cart_count"),r=document.querySelector(".dlCost");removeBasketChildren(e),removeChildren(document.querySelector(".ro_send_products")),t.innerHTML=0,r.innerHTML=0,document.getElementById("page-4").style.display="none"}),l.addEventListener("click",()=>{let t=document.getElementById("register_order");if(e.firstChild){let i=document.querySelector("div.register_order__info div.ro_product_list"),n=e.querySelectorAll("div.product_list__item"),l=document.querySelector(".ro_send_products");r.style.display="none",t.style.display="grid",removeChildren(i),removeChildren(l),registerOrderProductsFilling(n,i,l),roFillTotal(e,t)}})}function registerOrderProductsFilling(e,t,r){Array.from(e).forEach(e=>{let i=e.getAttribute("data-id"),n=e.getAttribute("data-weight"),l=e.querySelector("div.elt_name"),o=e.querySelector("div.elt_weight"),d=e.querySelector("div.elt_price");r.insertAdjacentHTML("afterbegin",`<input type="text" hidden name="order[]" value={"id":"${i}","weight":"${n}"}></input>`);let c=`\n            <div class="ro_product_list__item" data-id="${i}" data-weight="${n}">\n            <div class="elt_name">${l.textContent}</div>\n            <div class="elt_weight">${o.textContent}</div>\n            <div class="elt_price">${d.textContent}</div>\n        </div>`;t.insertAdjacentHTML("afterbegin",c)})}function roFillTotal(e,t){let r=e.parentElement.querySelector("div.total_price .total_price__item"),i=t.querySelector("div.register_order__info"),n=i.querySelector("span.ro_total_cost__summ"),l=Number(r.textContent);n.innerHTML=l;let o=i.querySelector("div.ro_delivery_price"),d=o.querySelector(".ro_delivery_price__summ"),c=o.querySelector(".ro_delivery__curr");l>=1e3?(d.innerHTML="Бесплатно",c.innerHTML=""):(d.innerHTML=150,n.innerHTML=l+Number(d.textContent),c.innerHTML=" руб.")}function buttonWeightHandler(t,e,s,a,i){t.forEach(t=>{isSelected(t,i)||t.addEventListener("click",n=>{e.textContent=t.getAttribute("data-price"),removeClassNameFromNodeList(s,i),t.classList.add(i),a.classList.remove(i),a.textContent="Выбрать"})})}function productCardHandler(e,t){let r="selected",d=document.querySelectorAll("div.product-card");Array.from(d).forEach(d=>{let o=d.getAttribute("data-pid"),c=d.querySelector("div.product_name").innerText,i=d.querySelectorAll("div.weights div.weights_item"),l=Array.from(i),u=d.querySelector("div.button-add"),a=u.querySelector("div.btn_add_text"),n=u.querySelector("div.tp-price");buttonWeightHandler(l,n,i,a,r),buttonAddProductToCartHandler(e,t,u,l,c,a,o,r)})}function scrollAnimation(){let t="selected",e=$("html,body");$('a[href*="#"]').click((function(){e.animate({scrollTop:$($.attr(this,"href")).offset().top},100)})),$("div.navbar_item").click((function(){return removeClassNameFromNodeList($("div.navbar_item"),t),!isSelected(this,t)&&this.classList.add(t),!1}))}function removeClassNameFromNodeList(e,t){Array.from(e).forEach(e=>{e.classList.contains(t)&&e.classList.remove(t)})}function isSelected(e,t){return e.classList.contains(t)}function removeBasketChildren(e){let t=e.parentElement.querySelector("div.total_price__item");removeChildren(e),t.textContent=0;let n=document.querySelectorAll("div.btn_add_text");Array.from(n).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.textContent="Выбрать")}))}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function basketFilling(e,t,n){let i=document.createElement("div");i.classList.add("product_list__item");let r=document.createElement("div");r.classList.add("elt_remove"),r.insertAdjacentHTML("afterbegin",'<img src="images/quit.png" alt="X">'),eltRemoveListener(r,t),i.appendChild(r);let d=`<div class="elt_name">${n.name}</div>\n    <div class="elt_weight">${n.weight}</div>    \n    <div class="elt_price">${n.price}</div>`;i.setAttribute("data-id",n.id),i.setAttribute("data-weight",n.dWeight),i.insertAdjacentHTML("beforeend",d),e.appendChild(i);let o=Number(n.price)+Number(t.textContent);t.textContent=o;let l=document.querySelector(".cart_count");l.innerHTML=Number(l.textContent)+1}function eltRemoveListener(e,t){let n=document.querySelector("div.dlCost"),i=document.querySelector("div.dlInfo-2");e.addEventListener("click",()=>{let r=e.parentElement,d=r.parentElement,o=r.getAttribute("data-id");t.textContent=Number(t.textContent)-Number(r.querySelector("div.elt_price").textContent),document.querySelector(`#pid-${o} div.button-add div.btn_add_text`).classList.remove("selected"),d.removeChild(r),setDeliveryPrice(t.textContent,n,i),document.getElementById("page-4").style.display=d.firstChild?"":"none";let l=document.querySelector(".cart_count");l.innerHTML=Number(l.textContent)-1})}function closeRegisterOrderPage(){document.getElementById("register_order").style.display="none",document.getElementById("page-4").style.display="grid"}function setDeliveryPrice(e,t,n){e>=1e3?0!=t.textContent&&(t.innerHTML="0",n.innerHTML="р. "):150!=t.textContent&&(t.innerHTML="150",n.innerHTML=" р. ")}function closeCookieMsg(){document.getElementById("cmsgc").parentNode.parentNode.style.display="none"}(()=>{let e=document.querySelector("div.basket_info div.product_list"),t=document.querySelector("div.basket_info div.total_price div.total_price__item");productCardHandler(e,t),scrollAnimation(),bascketHandler(e)})();