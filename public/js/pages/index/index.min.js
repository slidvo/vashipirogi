function buttonAddProductToCartHandler(t,e,i,n,a,c,d,r){i.addEventListener("click",(function(i){c.classList.contains(r)||n.forEach((function(i){isSelected(i,r)&&(c.classList.add(r),c.textContent="В корзине",basketFilling(t,e,{id:d,name:a,dWeight:i.getAttribute("data-weight"),weight:i.innerText,price:i.getAttribute("data-price")}))}))}))}function bascketHandler(e,t,r){let n=document.querySelector("div.button_basket"),d=document.querySelector(".page-4"),o=d.querySelector("button.b1"),i=d.querySelector("button.b2"),l=d.querySelector("button.b3");n.addEventListener("click",(function(t){if(e.firstChild){d.style.display="grid";let e=document.querySelector("div.dlCost"),t=document.querySelector("div.dlInfo-2"),r=document.querySelector(".total_price__item");Number(r.textContent)>=1e3?(e.textContent="",e.textContent="0",t.textContent="р."):(e.textContent="",e.textContent="150",t.textContent=" р.")}else alert("Корзина пустая :(")})),o.addEventListener("click",(function(e){d.style.display="none";let t=document.querySelectorAll("div.btn_add_text");Array.from(t).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.textContent="Выбрать")}))})),i.addEventListener("click",(function(t){removeBasketChildren(e)})),l.addEventListener("click",(function(t){let r=document.getElementById("register_order");if(e.firstChild){d.style.display="none",r.style.display="grid";let t=document.querySelector("div.register_order__info div.ro_product_list"),n=e.querySelectorAll("div.product_list__item"),o=document.querySelector(".ro_send_products");removeChildren(t),registerOrderProductsFilling(n,t,o),roFillTotal(e,r)}}))}function registerOrderProductsFilling(e,t,r){Array.from(e).forEach((function(e){let n=e.getAttribute("data-id"),d=e.getAttribute("data-weight"),o=e.querySelector("div.elt_name"),i=e.querySelector("div.elt_weight"),l=e.querySelector("div.elt_price"),c=document.createElement("div");c.classList.add("elt_name"),c.appendChild(document.createTextNode(o.textContent));let u=document.createElement("div");u.classList.add("elt_weight"),u.appendChild(document.createTextNode(i.textContent));let a=document.createElement("div");a.classList.add("elt_price"),a.appendChild(document.createTextNode(l.textContent));let s=document.createElement("input");s.setAttribute("type","text"),s.hidden=!0,s.setAttribute("name","order[]"),s.setAttribute("value",`{"id":"${n}","weight":"${d}"}`),r.appendChild(s);let _=document.createElement("div");_.classList.add("ro_product_list__item"),_.appendChild(c),_.appendChild(u),_.appendChild(a),_.setAttribute("data-id",n),_.setAttribute("data-weight",d),t.appendChild(_)}))}function roFillTotal(e,t){let r=e.parentElement.querySelector("div.total_price .total_price__item"),n=t.querySelector("div.register_order__info"),d=n.querySelector("span.ro_total_cost__summ"),o=Number(r.textContent);d.textContent=o;let i=n.querySelector("div.ro_delivery_price"),l=i.querySelector(".ro_delivery_price__summ"),c=i.querySelector(".ro_delivery__curr");l.textContent="",c.textContent="",o>=1e3?l.textContent="Бесплатно":(l.textContent=150,d.textContent=o+Number(l.textContent),c.textContent=" руб.")}function navbarClickHandler(e){let a=document.querySelector("div.navbar").querySelectorAll("div.navbar_links div.navbar_item");Array.from(a).forEach((function(r){r.addEventListener("click",(function(n){removeClassNameFromNodeList(a,e),isSelected(r,e)||r.classList.add(e)}))}))}function productCardHandler(e,t,r){let d=document.querySelectorAll("div.product-card");Array.from(d).forEach(d=>{let o=d.getAttribute("data-pid"),i=d.querySelector("div.product_name").innerText,u=d.querySelectorAll("div.weights div.weights_item"),c=Array.from(u),l=d.querySelector("div.button-add"),a=l.querySelector("div.btn_add_text"),n=l.querySelector("div.tp-price");buttonWeightHandler(c,n,u,a,r),buttonAddProductToCartHandler(e,t,l,c,i,a,o,r)})}function buttonWeightHandler(t,e,n,s,a){t.forEach(t=>{isSelected(t,a)||t.addEventListener("click",o=>{o.stopPropagation();let i=t.getAttribute("data-price");e.textContent=i||"unkonwn",removeClassNameFromNodeList(n,a),t.classList.add(a),s.classList.contains(a)&&(s.classList.remove(a),s.textContent="Выбрать")})})}function alertCookie(){alert("Используя наш сайт, вы даете согласие на обработку файлов cookie и пользовательских данных.")}function indexHandler(){const e="selected";let t=document.querySelector("div.basket_info div.product_list"),n=document.querySelector("div.basket_info div.total_price div.total_price__item");productCardHandler(t,n,e),navbarClickHandler(e),bascketHandler(t,150,e)}function removeClassNameFromNodeList(e,t){Array.from(e).forEach(e=>{e.classList.contains(t)&&e.classList.remove(t)})}function isSelected(e,t){return e.classList.contains(t)}function removeBasketChildren(e){let t=e.parentElement.querySelector("div.total_price__item");removeChildren(e),t.textContent=0;let n=document.querySelectorAll("div.btn_add_text");Array.from(n).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.textContent="Выбрать")}))}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function basketFilling(e,t,n){let d=document.createElement("div");d.classList.add("product_list__item");let i=document.createElement("div");i.classList.add("elt_remove");let l=document.createElement("img");l.src="images/quit.png",i.appendChild(l),eltRemoveListener(i,t),d.appendChild(i);let r=document.createElement("div"),o=document.createElement("div"),c=document.createElement("div");r.classList.add("elt_name"),o.classList.add("elt_weight"),c.classList.add("elt_price"),r.appendChild(document.createTextNode(n.name)),o.appendChild(document.createTextNode(n.weight)),c.appendChild(document.createTextNode(n.price)),d.setAttribute("data-id",n.id),d.setAttribute("data-weight",n.dWeight),d.appendChild(r),d.appendChild(o),d.appendChild(c),e.appendChild(d);let a=Number(n.price)+Number(t.textContent);t.textContent=a}function eltRemoveListener(e,t){let n=document.querySelector("div.dlCost"),d=document.querySelector("div.dlInfo-2");e.addEventListener("click",(function(i){let l=e.parentElement,r=l.querySelector("div.elt_price"),o=l.parentElement;if(t.textContent=Number(t.textContent)-Number(r.textContent),o.removeChild(l),Number(t.textContent)>=1e3?(n.textContent="",n.textContent="0",d.textContent="р."):(n.textContent="",n.textContent="150",d.textContent=" р."),!o.firstChild){let e=document.querySelector(".page-4");e.classList.remove("show"),e.classList.add("close"),t.textContent=0}}))}function closeRegisterOrderPage(){let e=document.getElementById("page-4");document.getElementById("register_order").style.display="none",e.style.display="grid"}indexHandler();