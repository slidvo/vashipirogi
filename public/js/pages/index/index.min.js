function buttonAddProductToCartHandler(t,e,i,a,n,d,c,r){i.addEventListener("click",()=>{d.classList.contains(r)||a.forEach(i=>{isSelected(i,r)&&(d.classList.add(r),d.textContent="В корзине",basketFilling(t,e,{id:c,name:n,dWeight:i.getAttribute("data-weight"),weight:i.innerText,price:i.getAttribute("data-price")}))})})}function bascketHandler(e){let t=document.querySelector("div.button_basket"),r=document.querySelector(".page-4"),i=r.querySelector("button.b1"),n=r.querySelector("button.b2"),l=r.querySelector("button.b3");t.addEventListener("click",()=>{if(e.firstChild){r.style.display="grid";let e=document.querySelector("div.dlCost"),t=document.querySelector("div.dlInfo-2"),i=document.querySelector(".total_price__item");setDeliveryPrice(i.textContent,e,t)}else alert("Корзина пустая :(")}),i.addEventListener("click",()=>{r.style.display="none"}),n.addEventListener("click",()=>{let t=document.querySelector(".cart_count"),r=document.querySelector(".dlCost");removeBasketChildren(e),removeChildren(document.querySelector(".ro_send_products")),t.innerHTML=0,r.innerHTML=0,document.getElementById("page-4").style.display="none"}),l.addEventListener("click",()=>{let t=document.getElementById("register_order");if(e.firstChild){let i=document.querySelector("div.register_order__info div.ro_product_list"),n=e.querySelectorAll("div.product_list__item"),l=document.querySelector(".ro_send_products");r.style.display="none",t.style.display="grid",removeChildren(i),removeChildren(l),registerOrderProductsFilling(n,i,l),roFillTotal(e,t)}})}function registerOrderProductsFilling(e,t,r){Array.from(e).forEach(e=>{let i=e.getAttribute("data-id"),n=e.getAttribute("data-weight"),l=e.querySelector("div.elt_name"),o=e.querySelector("div.elt_weight"),d=e.querySelector("div.elt_price");r.insertAdjacentHTML("afterbegin",`<input type="text" hidden name="order[]" value={"id":"${i}","weight":"${n}"}></input>`);let c=`\n            <div class="ro_product_list__item" data-id="${i}" data-weight="${n}">\n            <div class="elt_name">${l.textContent}</div>\n            <div class="elt_weight">${o.textContent}</div>\n            <div class="elt_price">${d.textContent}</div>\n        </div>`;t.insertAdjacentHTML("afterbegin",c)})}function roFillTotal(e,t){let r=e.parentElement.querySelector("div.total_price .total_price__item"),i=t.querySelector("div.register_order__info"),n=i.querySelector("span.ro_total_cost__summ"),l=Number(r.textContent);n.innerHTML=l;let o=i.querySelector("div.ro_delivery_price"),d=o.querySelector(".ro_delivery_price__summ"),c=o.querySelector(".ro_delivery__curr");l>=1e3?(d.innerHTML="Бесплатно",c.innerHTML=""):(d.innerHTML=150,n.innerHTML=l+Number(d.textContent),c.innerHTML=" руб.")}function buttonWeightHandler(t,e,s,a,i){t.forEach(t=>{isSelected(t,i)||t.addEventListener("click",n=>{e.textContent=t.getAttribute("data-price"),removeClassNameFromNodeList(s,i),t.classList.add(i),a.classList.remove(i),a.textContent="Выбрать"})})}function productCardHandler(e,t){let r="selected",d=document.querySelectorAll("div.product-card");Array.from(d).forEach(d=>{let o=d.getAttribute("data-pid"),c=d.querySelector("div.product_name").innerText,i=d.querySelectorAll("div.weights div.weights_item"),l=Array.from(i),u=d.querySelector("div.button-add"),a=u.querySelector("div.btn_add_text"),n=u.querySelector("div.tp-price");buttonWeightHandler(l,n,i,a,r),buttonAddProductToCartHandler(e,t,u,l,c,a,o,r)})}function scrollAnimation(){let t="selected",e=$("html,body");$('a[href*="#"]').click((function(){e.animate({scrollTop:$($.attr(this,"href")).offset().top},100)})),$("div.navbar_item").click((function(){return removeClassNameFromNodeList($("div.navbar_item"),t),!isSelected(this,t)&&this.classList.add(t),!1}))}var multiItemSlider=function(t,e){var r=document.querySelector(t),n=r.querySelector(".slider__wrapper"),i=r.querySelectorAll(".slider__item"),o=r.querySelectorAll(".slider__control"),l=(r.querySelector(".slider__control_left"),r.querySelector(".slider__control_right"),parseFloat(getComputedStyle(n).width)),a=parseFloat(getComputedStyle(i[0]).width),s=0,c=0,f=a/l*100,u=[];i.forEach((function(t,e){u.push({item:t,position:e,transform:0})}));var m={getItemMin:function(){var t=0;return u.forEach((function(e,r){e.position<u[t].position&&(t=r)})),t},getItemMax:function(){var t=0;return u.forEach((function(e,r){e.position>u[t].position&&(t=r)})),t},getMin:function(){return u[m.getItemMin()].position},getMax:function(){return u[m.getItemMax()].position}},g=function(t){var e;"right"===t&&(++s+l/a-1>m.getMax()&&(e=m.getItemMin(),u[e].position=m.getMax()+1,u[e].transform+=100*u.length,u[e].item.style.transform="translateX("+u[e].transform+"%)"),c-=f),"left"===t&&(--s<m.getMin()&&(e=m.getItemMax(),u[e].position=m.getMin()-1,u[e].transform-=100*u.length,u[e].item.style.transform="translateX("+u[e].transform+"%)"),c+=f),n.style.transform="translateX("+c+"%)"},d=function(t){if(t.target.classList.contains("slider__control")){t.preventDefault();var e=t.target.classList.contains("slider__control_right")?"right":"left";g(e)}};return o.forEach((function(t){t.addEventListener("click",d)})),{right:function(){g("right")},left:function(){g("left")}}},slider=multiItemSlider(".slider");function cookieCloseMsg(){let e=getCookie("cmsg");"true"!=e&&null!=e||document.querySelector(".cookies_msg__close").addEventListener("click",()=>{document.getElementById("cmsgc").parentNode.parentNode.style.display="none",document.cookie="cmsg=false"},!1)}function removeClassNameFromNodeList(e,t){Array.from(e).forEach(e=>{e.classList.contains(t)&&e.classList.remove(t)})}function isSelected(e,t){return e.classList.contains(t)}function removeBasketChildren(e){let t=e.parentElement.querySelector("div.total_price__item"),n=document.querySelectorAll("div.btn_add_text.selected");removeChildren(e),t.innerHTML=0,Array.from(n).forEach(e=>{e.classList.remove("selected"),e.innerHTML="Выбрать"})}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function basketFilling(e,t,n){let i=document.createElement("div");i.classList.add("product_list__item");let r=document.createElement("div");r.classList.add("elt_remove"),r.insertAdjacentHTML("afterbegin",'<img src="images/quit.png" alt="X">'),eltRemoveListener(r,t),i.appendChild(r);let o=`<div class="elt_name">${n.name}</div>\n    <div class="elt_weight">${n.weight}</div>    \n    <div class="elt_price">${n.price}</div>`;i.setAttribute("data-id",n.id),i.setAttribute("data-weight",n.dWeight),i.insertAdjacentHTML("beforeend",o),e.appendChild(i);let d=Number(n.price)+Number(t.textContent);t.textContent=d,cartCounter(document.querySelector(".cart_count"),"+")}function cartCounter(e,t){switch(t){case"+":e.innerHTML=parseInt(e.textContent)+1;break;case"-":e.innerHTML=parseInt(e.textContent)-1;break;default:console.log(`This sign ${t} does not supporting`)}}function eltRemoveListener(e,t){let n=document.querySelector("div.dlCost"),i=document.querySelector("div.dlInfo-2");e.addEventListener("click",()=>{let r=e.parentElement,o=r.parentElement,d=r.getAttribute("data-id");t.textContent=Number(t.textContent)-Number(r.querySelector("div.elt_price").textContent),document.querySelector(`#pid-${d} div.button-add div.btn_add_text`).classList.remove("selected"),o.removeChild(r),setDeliveryPrice(t.textContent,n,i),document.getElementById("page-4").style.display=o.firstChild?"":"none",cartCounter(document.querySelector(".cart_count"),"-")})}function closeRegisterOrderPage(){document.getElementById("register_order").style.display="none",document.getElementById("page-4").style.display="grid"}function setDeliveryPrice(e,t,n){e>=1e3?0!=t.textContent&&(t.innerHTML="0",n.innerHTML="р. "):150!=t.textContent&&(t.innerHTML="150",n.innerHTML=" р. ")}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function phoneMask(){let e=document.getElementById("phone");e.addEventListener("blur",()=>{let t="",n=e.value.split(" ");n.forEach(e=>{t+=e}),n[0]!=e.value&&(console.log(n),e.value=t)},!1)}(()=>{let e=document.querySelector("div.basket_info div.product_list"),t=document.querySelector("div.basket_info div.total_price div.total_price__item");productCardHandler(e,t),scrollAnimation(),bascketHandler(e),cookieCloseMsg(),phoneMask()})();