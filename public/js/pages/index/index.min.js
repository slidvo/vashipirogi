function buttonAddProductToCartHandler(t,e,i,a,n,d,c,r){i.addEventListener("click",()=>{d.classList.contains(r)||a.forEach(i=>{isSelected(i,r)&&(d.classList.add(r),d.textContent="В корзине",basketFilling(t,e,{id:c,name:n,dWeight:i.getAttribute("data-weight"),weight:i.innerText,price:i.getAttribute("data-price")}))})})}function bascketHandler(e){let t=document.querySelector("div.button_basket"),r=document.querySelector(".page-4"),i=r.querySelector("button.b1"),n=r.querySelector("button.b2"),o=r.querySelector("button.b3");t.addEventListener("click",(function(t){if(e.firstChild){r.style.display="grid";let e=document.querySelector("div.dlCost"),t=document.querySelector("div.dlInfo-2"),i=document.querySelector(".total_price__item");setDeliveryPrice(i.textContent,e,t)}else alert("Корзина пустая :(");t.stopPropagation()}),!1),i.addEventListener("click",(function(e){r.style.display="none",e.stopPropagation()}),!1),n.addEventListener("click",(function(t){removeBasketChildren(e),document.querySelector(".cart_count").innerHTML=0,document.querySelector(".dlCost").innerHTML=0,document.getElementById("page-4").style.display="none",t.stopPropagation()}),!1),o.addEventListener("click",(function(t){let i=document.getElementById("register_order");if(e.firstChild){r.style.display="none",i.style.display="grid";let t=document.querySelector("div.register_order__info div.ro_product_list"),n=e.querySelectorAll("div.product_list__item"),o=document.querySelector(".ro_send_products");removeChildren(t),registerOrderProductsFilling(n,t,o),roFillTotal(e,i)}t.stopPropagation()}),!1)}function registerOrderProductsFilling(e,t,r){Array.from(e).forEach((function(e){let i=e.getAttribute("data-id"),n=e.getAttribute("data-weight"),o=e.querySelector("div.elt_name"),d=e.querySelector("div.elt_weight"),l=e.querySelector("div.elt_price"),c=document.createElement("div");c.classList.add("elt_name"),c.appendChild(document.createTextNode(o.textContent));let u=document.createElement("div");u.classList.add("elt_weight"),u.appendChild(document.createTextNode(d.textContent));let a=document.createElement("div");a.classList.add("elt_price"),a.appendChild(document.createTextNode(l.textContent));let s=document.createElement("input");s.setAttribute("type","text"),s.hidden=!0,s.setAttribute("name","order[]"),s.setAttribute("value",`{"id":"${i}","weight":"${n}"}`),r.appendChild(s);let p=document.createElement("div");p.classList.add("ro_product_list__item"),p.appendChild(c),p.appendChild(u),p.appendChild(a),p.setAttribute("data-id",i),p.setAttribute("data-weight",n),t.appendChild(p)}))}function roFillTotal(e,t){let r=e.parentElement.querySelector("div.total_price .total_price__item"),i=t.querySelector("div.register_order__info"),n=i.querySelector("span.ro_total_cost__summ"),o=Number(r.textContent);n.innerHTML=o;let d=i.querySelector("div.ro_delivery_price"),l=d.querySelector(".ro_delivery_price__summ"),c=d.querySelector(".ro_delivery__curr");o>=1e3?(l.innerHTML="Бесплатно",c.innerHTML=""):(l.innerHTML=150,n.innerHTML=o+Number(l.textContent),c.innerHTML=" руб.")}function buttonWeightHandler(t,e,s,a,i){t.forEach(t=>{isSelected(t,i)||t.addEventListener("click",n=>{let c=t.getAttribute("data-price");e.textContent=c||"err",removeClassNameFromNodeList(s,i),t.classList.add(i),a.classList.contains(i)&&(a.classList.remove(i),a.textContent="Выбрать")})})}function scrollAnimation(){let t="selected",e=$("html,body");$('a[href*="#"]').click((function(){e.animate({scrollTop:$($.attr(this,"href")).offset().top},100)})),$("div.navbar_item").click((function(){return removeClassNameFromNodeList($("div.navbar_item"),t),!isSelected(this,t)&&this.classList.add(t),!1}))}function productCardHandler(e,t,r){let d=document.querySelectorAll("div.product-card");Array.from(d).forEach(d=>{let o=d.getAttribute("data-pid"),i=d.querySelector("div.product_name").innerText,u=d.querySelectorAll("div.weights div.weights_item"),c=Array.from(u),l=d.querySelector("div.button-add"),a=l.querySelector("div.btn_add_text"),n=l.querySelector("div.tp-price");buttonWeightHandler(c,n,u,a,r),buttonAddProductToCartHandler(e,t,l,c,i,a,o,r)})}function indexHandler(){let e=document.querySelector("div.basket_info div.product_list"),t=document.querySelector("div.basket_info div.total_price div.total_price__item");productCardHandler(e,t,"selected"),scrollAnimation(),bascketHandler(e)}function removeClassNameFromNodeList(e,t){Array.from(e).forEach(e=>{e.classList.contains(t)&&e.classList.remove(t)})}function isSelected(e,t){return e.classList.contains(t)}function removeBasketChildren(e){let t=e.parentElement.querySelector("div.total_price__item");removeChildren(e),t.textContent=0;let n=document.querySelectorAll("div.btn_add_text");Array.from(n).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.textContent="Выбрать")}))}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function basketFilling(e,t,n){let i=document.createElement("div");i.classList.add("product_list__item");let r=document.createElement("div");r.classList.add("elt_remove"),r.insertAdjacentHTML("afterbegin",'<img src="images/quit.png" alt="X">'),eltRemoveListener(r,t),i.appendChild(r);let d=`<div class="elt_name">${n.name}</div>\n    <div class="elt_weight">${n.weight}</div>    \n    <div class="elt_price">${n.price}</div>`;i.setAttribute("data-id",n.id),i.setAttribute("data-weight",n.dWeight),i.insertAdjacentHTML("beforeend",d),e.appendChild(i);let l=Number(n.price)+Number(t.textContent);t.textContent=l;let o=document.querySelector(".cart_count");o.innerHTML=Number(o.textContent)+1}function eltRemoveListener(e,t){let n=document.querySelector("div.dlCost"),i=document.querySelector("div.dlInfo-2");e.addEventListener("click",()=>{let r=e.parentElement,d=r.parentElement,l=r.getAttribute("data-id");t.textContent=Number(t.textContent)-Number(r.querySelector("div.elt_price").textContent),document.querySelector(`#pid-${l} div.button-add div.btn_add_text`).classList.remove("selected"),d.removeChild(r),setDeliveryPrice(t.textContent,n,i),document.getElementById("page-4").style.display=d.firstChild?"":"none";let o=document.querySelector(".cart_count");o.innerHTML=Number(o.textContent)-1})}function closeRegisterOrderPage(){document.getElementById("register_order").style.display="none",document.getElementById("page-4").style.display="grid"}function setDeliveryPrice(e,t,n){e>=1e3?0!=t.textContent&&(t.innerHTML="0",n.innerHTML="р. "):150!=t.textContent&&(t.innerHTML="150",n.innerHTML=" р. ")}function closeCookieMsg(){document.getElementById("cmsgc").parentNode.parentNode.style.display="none"}indexHandler();