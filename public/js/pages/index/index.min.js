function buttonAddProductToCartHandler(t,e,i,n,a,c,d,r){i.addEventListener("click",(function(i){c.classList.contains(r)||n.forEach((function(i){isSelected(i,r)&&(c.classList.add(r),c.textContent="В корзине",basketFilling(t,e,{id:d,name:a,dWeight:i.getAttribute("data-weight"),weight:i.innerText,price:i.getAttribute("data-price")}))}))}))}function bascketHandler(e,t,r){let n=document.querySelector("div.button_basket"),d=document.querySelector(".page-4"),i=d.querySelector("button.b1"),l=d.querySelector("button.b2"),o=d.querySelector("button.b3");n.addEventListener("click",(function(t){if(e.firstChild){d.style.display="grid";let e=document.querySelector("div.dlCost"),t=document.querySelector("div.dlInfo-2"),r=document.querySelector(".total_price__item");setDeliveryPrice(r.textContent,e,t)}else alert("Корзина пустая :(")})),i.addEventListener("click",(function(e){d.style.display="none";let t=document.querySelectorAll("div.btn_add_text");Array.from(t).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.innerHTML="Выбрать")}))})),l.addEventListener("click",(function(){removeBasketChildren(e),document.querySelector(".cart_count").innerHTML=0,document.querySelector(".dlCost").innerHTML=0,document.getElementById("page-4").style.display="none"})),o.addEventListener("click",(function(t){let r=document.getElementById("register_order");if(e.firstChild){d.style.display="none",r.style.display="grid";let t=document.querySelector("div.register_order__info div.ro_product_list"),n=e.querySelectorAll("div.product_list__item"),i=document.querySelector(".ro_send_products");removeChildren(t),registerOrderProductsFilling(n,t,i),roFillTotal(e,r)}}))}function registerOrderProductsFilling(e,t,r){Array.from(e).forEach((function(e){let n=e.getAttribute("data-id"),d=e.getAttribute("data-weight"),i=e.querySelector("div.elt_name"),l=e.querySelector("div.elt_weight"),o=e.querySelector("div.elt_price"),c=document.createElement("div");c.classList.add("elt_name"),c.appendChild(document.createTextNode(i.textContent));let u=document.createElement("div");u.classList.add("elt_weight"),u.appendChild(document.createTextNode(l.textContent));let a=document.createElement("div");a.classList.add("elt_price"),a.appendChild(document.createTextNode(o.textContent));let s=document.createElement("input");s.setAttribute("type","text"),s.hidden=!0,s.setAttribute("name","order[]"),s.setAttribute("value",`{"id":"${n}","weight":"${d}"}`),r.appendChild(s);let _=document.createElement("div");_.classList.add("ro_product_list__item"),_.appendChild(c),_.appendChild(u),_.appendChild(a),_.setAttribute("data-id",n),_.setAttribute("data-weight",d),t.appendChild(_)}))}function roFillTotal(e,t){let r=e.parentElement.querySelector("div.total_price .total_price__item"),n=t.querySelector("div.register_order__info"),d=n.querySelector("span.ro_total_cost__summ"),i=Number(r.textContent);d.textContent=i;let l=n.querySelector("div.ro_delivery_price"),o=l.querySelector(".ro_delivery_price__summ"),c=l.querySelector(".ro_delivery__curr");o.textContent="",c.textContent="",i>=1e3?o.textContent="Бесплатно":(o.textContent=150,d.textContent=i+Number(o.textContent),c.textContent=" руб.")}function buttonWeightHandler(t,e,n,s,a){t.forEach(t=>{isSelected(t,a)||t.addEventListener("click",o=>{o.stopPropagation();let i=t.getAttribute("data-price");e.textContent=i||"unkonwn",removeClassNameFromNodeList(n,a),t.classList.add(a),s.classList.contains(a)&&(s.classList.remove(a),s.textContent="Выбрать")})})}function navbarClickHandler(e){let a=document.querySelector("div.navbar").querySelectorAll("div.navbar_links div.navbar_item");Array.from(a).forEach((function(r){r.addEventListener("click",(function(n){removeClassNameFromNodeList(a,e),isSelected(r,e)||r.classList.add(e)}))}))}function productCardHandler(e,t,r){let d=document.querySelectorAll("div.product-card");Array.from(d).forEach(d=>{let o=d.getAttribute("data-pid"),i=d.querySelector("div.product_name").innerText,u=d.querySelectorAll("div.weights div.weights_item"),c=Array.from(u),l=d.querySelector("div.button-add"),a=l.querySelector("div.btn_add_text"),n=l.querySelector("div.tp-price");buttonWeightHandler(c,n,u,a,r),buttonAddProductToCartHandler(e,t,l,c,i,a,o,r)})}function alertCookie(){alert("Используя наш сайт, вы даете согласие на обработку файлов cookie и пользовательских данных.")}function indexHandler(){const e="selected";let t=document.querySelector("div.basket_info div.product_list"),n=document.querySelector("div.basket_info div.total_price div.total_price__item");productCardHandler(t,n,e),navbarClickHandler(e),bascketHandler(t,150,e)}function removeClassNameFromNodeList(e,t){Array.from(e).forEach(e=>{e.classList.contains(t)&&e.classList.remove(t)})}function isSelected(e,t){return e.classList.contains(t)}function removeBasketChildren(e){let t=e.parentElement.querySelector("div.total_price__item");removeChildren(e),t.textContent=0;let n=document.querySelectorAll("div.btn_add_text");Array.from(n).forEach((function(e){isSelected(e,"selected")&&(e.classList.remove("selected"),e.textContent="Выбрать")}))}function removeChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function basketFilling(e,t,n){let i=document.createElement("div");i.classList.add("product_list__item");let r=document.createElement("div");r.classList.add("elt_remove"),r.insertAdjacentHTML("afterbegin",'<img src="images/quit.png" alt="X">'),eltRemoveListener(r,t),i.appendChild(r);let l=`<div class="elt_name">${n.name}</div>\n    <div class="elt_weight">${n.weight}</div>    \n    <div class="elt_price">${n.price}</div>`;i.setAttribute("data-id",n.id),i.setAttribute("data-weight",n.dWeight),i.insertAdjacentHTML("beforeend",l),e.appendChild(i);let d=Number(n.price)+Number(t.textContent);t.textContent=d;let o=document.querySelector(".cart_count");o.innerHTML=Number(o.textContent)+1}function eltRemoveListener(e,t){let n=document.querySelector("div.dlCost"),i=document.querySelector("div.dlInfo-2");e.addEventListener("click",(function(r){let l=e.parentElement,d=l.querySelector("div.elt_price"),o=l.parentElement;if(t.textContent=Number(t.textContent)-Number(d.textContent),o.removeChild(l),setDeliveryPrice(t.textContent,n,i),null===o.firstChild){document.getElementById("page-4").style.display="none"}let c=document.querySelector(".cart_count");c.innerHTML=Number(c.textContent)-1}))}function closeRegisterOrderPage(){let e=document.getElementById("page-4");document.getElementById("register_order").style.display="none",e.style.display="grid"}function setDeliveryPrice(e,t,n){e>=1e3?0!=t.textContent&&(t.innerHTML="0",n.innerHTML="р. "):150!=t.textContent&&(t.innerHTML="150",n.innerHTML=" р. ")}indexHandler();